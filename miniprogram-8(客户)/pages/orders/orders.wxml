<!-- order-page.wxml -->

<view class="top"> 
  <view class="orderManager">è®¢å•ç®¡ç†</view>
  <view class="order-page">
  <view class="tabs">
    <view class="{{currentTab === 'all' ? 'active-tab' : ''}}" bindtap="all">å…¨éƒ¨</view>
    <view class="{{currentTab === 'unpaid' ? 'active-tab' : ''}}" bindtap="unpaid">å¾…æ”¯ä»˜</view>
    <view class="{{currentTab === 'inService' ? 'active-tab' : ''}}" bindtap="inService">æœåŠ¡ä¸­</view>
    <view class="{{currentTab === 'completed' ? 'active-tab' : ''}}" bindtap="completed">å·²å®Œæˆ</view>
    <view class="{{currentTab === 'refund' ? 'active-tab' : ''}}" bindtap="refund">å”®å</view>
  </view>
  <!-- åœ¨è¿™é‡Œæ·»åŠ è®¢å•åˆ—è¡¨ -->  
</view>

<view class="order-list">
    <view class="order-item" wx:for="{{orders}}" wx:for-item="order" wx:key="{{order.order_number}}">
      <view class="order-preview">
        <text class="order-preview-label">å°±è¯ŠåŒ»é™¢ï¼š</text>
        <text class="order-preview-value">{{order.selectedHospitalName}}</text>
        <text class="order-preview-label">å°±è¯Šç§‘å®¤ï¼š</text>
        <text class="order-preview-value">{{order.department}}</text>
        <text class="order-preview-label">å°±è¯Šæ—¥æœŸï¼š</text>
        <text class="order-preview-value">{{order.selectedDate}}</text>
        <text class="order-preview-label">å°±è¯Šæ—¶é—´ï¼š</text>
        <text class="order-preview-value">{{order.selectedTime}}</text>
        <text class="order-preview-label">ä¸‹å•æ—¶é—´ï¼š</text>
        <text class="order-preview-value">{{order.orderTime}}</text>
        <text class="order-preview-label">è®¢å•çŠ¶æ€ï¼š</text>
        <text class="order-preview-value">{{order.status}}</text>
        <!-- <view style="border-bottom: solid rgb(173, 119, 119);">111</view> -->
        <view class="button-container">
          <view  class="button_all" bindtap="deleteOrder" data-order="{{order}}" wx:if="{{order.status === 'å·²å®Œæˆ'}}">åˆ é™¤è®¢å•</view>
          <view  class="button_all"  bindtap="cancelOrder" data-order="{{order}}" wx:if="{{order.status === 'å¾…æ”¯ä»˜'}}">å–æ¶ˆè®¢å•</view>
          <view  class="button_all" bindtap="goPay" data-order="{{order}}" wx:if="{{order.status === 'å¾…æ”¯ä»˜'}}">ä»˜æ¬¾</view>
          <view  class="button_all" bindtap="showListModal" data-order="{{order}}" wx:if="{{order.status === 'å·²å®Œæˆ'}}">å¤‡å¿˜æ¸…å•</view>
          <view class="button_all"  bindtap="entryRefund" data-order="{{order}}" wx:if="{{order.status === 'æœåŠ¡ä¸­'}}">è¿›å…¥å”®å</view>
          <view  class="button_all" bindtap="cancelRefund" data-order="{{order}}" wx:if="{{order.status === 'å”®å'}}">å–æ¶ˆå”®å</view>
          <view  class="button_all"  bindtap="afterRefund" data-order="{{order}}" wx:if="{{order.status === 'å”®å'}}">ç¡®è®¤å”®å</view>
          <view  class="button_all"  bindtap="finishOrder" data-order="{{order}}" wx:if="{{order.status === 'æœåŠ¡ä¸­'}}">å®Œæˆè®¢å•</view>
          <view  class="button_all" style="border: 4rpx solid #FFA500;color: #FFA500;" bindtap="viewOrder" data-order="{{order}}">è®¢å•è¯¦æƒ…</view>
        </view>
      </view>
    </view>

    <!-- å½“è®¢å•åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œæ˜¾ç¤º "æ— è®¢å•" æ¶ˆæ¯ -->
    <view wx:if="{{orders.length === 0}}" class="no-order-message">
      æ— è®¢å•
    </view>
</view>

<!-- å¼¹å‡ºå±‚ -->
<view wx:if="{{ showModal }}" class="modal">
  <view class="modal-content">
    <view class="modal-title">
      è®¢å•è¯¦æƒ…
    </view>
    <!-- å¼¹å‡ºå±‚å†…å®¹ -->
    <view class="modal-body">
       <!-- è¯¦æƒ…å†…å®¹ -->
        <view class="label-value-pair">
          <text class="order-label">å§“åï¼š</text>
          <text class="order-value">{{modalOrder.name}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">èº«ä»½è¯ï¼š</text>
          <text class="order-value">{{modalOrder.idCard}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">æ‰‹æœºå·ï¼š</text>
          <text class="order-value">{{modalOrder.phoneNumber}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">å°±è¯ŠåŸå¸‚ï¼š</text>
          <text class="order-value">{{modalOrder.city}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">å°±è¯ŠåŒ»é™¢ï¼š</text>
          <text class="order-value">{{modalOrder.selectedHospitalName}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">å°±è¯Šç§‘å®¤ï¼š</text>
          <text class="order-value">{{modalOrder.department}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">å°±è¯Šæ—¥æœŸï¼š</text>
          <text class="order-value">{{modalOrder.selectedDate}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">å°±è¯Šæ—¶é—´ï¼š</text>
          <text class="order-value">{{modalOrder.selectedTime}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">è®¢å•å·ï¼š</text>
          <text class="order-value">{{modalOrder.orderNumber}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">ä¸‹å•æ—¶é—´ï¼š</text>
          <text class="order-value">{{modalOrder.orderTime}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">ä»·æ ¼ï¼š</text>
          <text class="order-value">{{modalOrder.price}}</text>
        </view>
        <view class="label-value-pair">
          <text class="order-label">æœåŠ¡éœ€æ±‚ï¼š</text>
          <text class="order-value">{{modalOrder.requirement}}</text>
        </view>
    </view>  
    <view class="modal-footer">
        <view class="button-container_1">
          <view bindtap="hideModal" class="closed_2">å…³é—­</view>
        </view>
    </view>  
  </view>
</view>      


<!-- å¼¹å‡ºå±‚ -->
<view wx:if="{{ showListModal }}" class="modal">
  <view class="modal-content">
    <view class="modal-title">å¤‡å¿˜æ¸…å•</view>
    <!-- å¼¹å‡ºå±‚å†…å®¹ -->
    <view class="modal-body">
      <!-- å¤‡å¿˜æ¸…å•å†…å®¹ -->
      <!--  æ–‡æœ¬ -->
      <view class="textareaTitle">å¤‡å¿˜æ–‡æœ¬ï¼š</view>
      <view>
        <textarea
          bindinput="onTextareaInput"
          maxlength="200"
          auto-height
          disabled="{{listSubmitted}}"
          value="{{textareaValue}}"
        >
        
        
        
        <!-- <view bindtap="hideListModal" style="float: right;"wx:if="{{!listSubmitted}}" >ğŸ”ˆ</view> -->
        </textarea>
        
      </view>


      <view wx:if="{{!listSubmitted}}">
        <button class="yuyinBtn {{recordState == true ? 'yuyinBtnBg':''}}" bindtouchstart="touchStart" bindtouchend="touchEnd">
          <text wx:if="{{recordState == false}}">æŒ‰ä½ è¯´è¯</text>
          <text wx:else>æ¾å¼€ ç»“æŸ</text>
        </button>
       </view>
       <cover-view class="startYuyinImage" wx:if="{{recordState == true}}">
         <cover-image src="/images/300.jpg"></cover-image>
        <cover-view>å¼€å§‹è¯­éŸ³</cover-view>
       </cover-view>
      <!-- å›¾ç‰‡ -->
      <view class="imggeTitle">å¤‡å¿˜å›¾ç‰‡ï¼š</view>
      <view class="imageList">
        <view class="imageItem" wx:for="{{imageList}}" wx:key="index">
            <image class="image"  mode="aspectFill" bindtap="chooseImage"  data-type="pictures"  data-index="{{index}}" src="{{item.url}}"  alt="Image" /> 
            <!-- bindtap="previewImage" -->
            <view class="delImage" catchtap="delImage" data-idnex="{{index}}" wx:if="{{!listSubmitted}}">-</view>
        </view>
        <view class="imageItem addImage" bindtap="chooseImage"  data-type="pictures" wx:if="{{!hideAddImage}}" wx:if="{{!listSubmitted}}"></view>
        
      </view>
    </view>
    <view class="modal-footer">
      <view class="button-container_1">
        <view bindtap="hideListModal" class="closed">å…³é—­</view>
        <view bindtap="wordYun" wx:if="{{listSubmitted}}" class="submit">æ’­æ”¾</view>
        <view bindtap="submitList" wx:if="{{!listSubmitted}}" class="submit">æäº¤</view>
      </view>
    </view>
  </view>
</view>
</view>


